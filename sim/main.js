var W, H;

var units; // = [{ pivot: ..., member: [{x: y:}] }]
var sources = [[]];
var sourceLength;

var board = [], initialBoard = [];
var $cell = [];
var score = [];

var key = [];
var spells = [
	"ei!" ,
	"ia! ia!",
	"r'lyeh",
	"ph'nglui mglw'nafh cthulhu r'lyeh wgah'nagl fhtagn."
];

var nowUnit;
var unitId;

var Tbl = [
	{ key: "p'!.03", val: "W" },
	{ key: "bcefy2", val: "E" },
	{ key: "aghij4", val: "SW" },
	{ key: "lmno 5", val: "SE" },
	{ key: "dqrvz1", val: "CW" },
	{ key: "kstuwx", val: "CCW" }
];
var tbl = {};
var Record = [];

var probs = [
	{"height":10,"width":10,"sourceSeeds":[0],"units":[{"members":[{"x":0,"y":0}],"pivot":{"x":0,"y":0}},{"members":[{"x":0,"y":0},{"x":2,"y":0}],"pivot":{"x":1,"y":0}},{"members":[{"x":0,"y":0},{"x":0,"y":2}],"pivot":{"x":0,"y":1}},{"members":[{"x":2,"y":0},{"x":0,"y":1},{"x":2,"y":2}],"pivot":{"x":1,"y":1}},{"members":[{"x":0,"y":0},{"x":1,"y":1},{"x":0,"y":2}],"pivot":{"x":0,"y":1}},{"members":[{"x":0,"y":0},{"x":1,"y":0}],"pivot":{"x":0,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0}],"pivot":{"x":1,"y":0}},{"members":[{"x":0,"y":0},{"x":0,"y":1}],"pivot":{"x":0,"y":0}},{"members":[{"x":0,"y":0},{"x":0,"y":1}],"pivot":{"x":0,"y":1}},{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":2,"y":0}],"pivot":{"x":0,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":2,"y":0}],"pivot":{"x":1,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":2,"y":0}],"pivot":{"x":2,"y":0}},{"members":[{"x":0,"y":0},{"x":0,"y":1},{"x":0,"y":2}],"pivot":{"x":0,"y":0}},{"members":[{"x":0,"y":0},{"x":0,"y":1},{"x":0,"y":2}],"pivot":{"x":0,"y":1}},{"members":[{"x":0,"y":0},{"x":0,"y":1},{"x":0,"y":2}],"pivot":{"x":0,"y":2}},{"members":[{"x":1,"y":0},{"x":0,"y":1},{"x":1,"y":2}],"pivot":{"x":1,"y":0}},{"members":[{"x":1,"y":0},{"x":0,"y":1},{"x":1,"y":2}],"pivot":{"x":1,"y":1}},{"members":[{"x":1,"y":0},{"x":0,"y":1},{"x":1,"y":2}],"pivot":{"x":1,"y":2}}],"id":0,"filled":[],"sourceLength":100},
	{"height":15,"width":15,"sourceSeeds":[0],"units":[{"members":[{"x":0,"y":0}],"pivot":{"x":0,"y":0}}],"id":1,"filled":[{"x":2,"y":4},{"x":3,"y":4},{"x":4,"y":4},{"x":5,"y":4},{"x":6,"y":4},{"x":11,"y":4},{"x":2,"y":5},{"x":8,"y":5},{"x":11,"y":5},{"x":2,"y":6},{"x":11,"y":6},{"x":2,"y":7},{"x":3,"y":7},{"x":4,"y":7},{"x":8,"y":7},{"x":11,"y":7},{"x":2,"y":8},{"x":9,"y":8},{"x":11,"y":8},{"x":2,"y":9},{"x":8,"y":9},{"x":2,"y":10},{"x":3,"y":10},{"x":4,"y":10},{"x":5,"y":10},{"x":6,"y":10},{"x":9,"y":10},{"x":11,"y":10}],"sourceLength":100},
	{"height":30,"width":15,"sourceSeeds":[0,679,13639,13948,29639,15385,16783,23862,25221,23027],"units":[{"members":[{"x":2,"y":0},{"x":1,"y":1},{"x":1,"y":2},{"x":0,"y":3},{"x":0,"y":4}],"pivot":{"x":1,"y":2}},{"members":[{"x":3,"y":0},{"x":2,"y":0},{"x":1,"y":1},{"x":1,"y":2},{"x":0,"y":3}],"pivot":{"x":1,"y":1}},{"members":[{"x":2,"y":1},{"x":2,"y":0},{"x":1,"y":1},{"x":1,"y":2},{"x":0,"y":3}],"pivot":{"x":1,"y":1}},{"members":[{"x":1,"y":0},{"x":2,"y":0},{"x":1,"y":1},{"x":1,"y":2},{"x":0,"y":3}],"pivot":{"x":1,"y":1}},{"members":[{"x":1,"y":0},{"x":1,"y":1},{"x":1,"y":2},{"x":0,"y":3},{"x":0,"y":4}],"pivot":{"x":0,"y":2}},{"members":[{"x":2,"y":2},{"x":1,"y":1},{"x":2,"y":0},{"x":1,"y":2},{"x":0,"y":3}],"pivot":{"x":1,"y":1}},{"members":[{"x":3,"y":0},{"x":2,"y":1},{"x":1,"y":1},{"x":1,"y":2},{"x":0,"y":3}],"pivot":{"x":1,"y":1}},{"members":[{"x":3,"y":0},{"x":2,"y":0},{"x":1,"y":0},{"x":0,"y":1},{"x":0,"y":2}],"pivot":{"x":1,"y":1}},{"members":[{"x":2,"y":1},{"x":2,"y":0},{"x":1,"y":0},{"x":0,"y":1},{"x":0,"y":2}],"pivot":{"x":1,"y":1}},{"members":[{"x":1,"y":1},{"x":2,"y":0},{"x":1,"y":0},{"x":0,"y":1},{"x":0,"y":2}],"pivot":{"x":1,"y":1}},{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":2,"y":0},{"x":0,"y":1},{"x":0,"y":2}],"pivot":{"x":1,"y":1}},{"members":[{"x":1,"y":0},{"x":1,"y":1},{"x":2,"y":1},{"x":1,"y":2},{"x":0,"y":3}],"pivot":{"x":1,"y":1}},{"members":[{"x":1,"y":2},{"x":0,"y":1},{"x":2,"y":0},{"x":1,"y":0},{"x":0,"y":2}],"pivot":{"x":1,"y":1}},{"members":[{"x":0,"y":1},{"x":1,"y":1},{"x":3,"y":0},{"x":2,"y":0},{"x":1,"y":2}],"pivot":{"x":1,"y":1}},{"members":[{"x":0,"y":3},{"x":0,"y":2},{"x":2,"y":0},{"x":1,"y":0},{"x":0,"y":1}],"pivot":{"x":1,"y":1}},{"members":[{"x":0,"y":2},{"x":1,"y":2},{"x":3,"y":0},{"x":2,"y":0},{"x":1,"y":1}],"pivot":{"x":1,"y":1}},{"members":[{"x":2,"y":1},{"x":1,"y":1},{"x":1,"y":0},{"x":0,"y":1},{"x":0,"y":2}],"pivot":{"x":1,"y":1}},{"members":[{"x":2,"y":2},{"x":1,"y":1},{"x":1,"y":0},{"x":0,"y":1},{"x":0,"y":2}],"pivot":{"x":1,"y":1}},{"members":[{"x":1,"y":2},{"x":1,"y":1},{"x":1,"y":0},{"x":0,"y":1},{"x":0,"y":2}],"pivot":{"x":0,"y":1}},{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":1,"y":1},{"x":0,"y":1},{"x":0,"y":2}],"pivot":{"x":0,"y":1}},{"members":[{"x":0,"y":1},{"x":1,"y":1},{"x":2,"y":1},{"x":2,"y":0},{"x":1,"y":2}],"pivot":{"x":1,"y":1}},{"members":[{"x":0,"y":3},{"x":0,"y":2},{"x":1,"y":1},{"x":1,"y":0},{"x":0,"y":1}],"pivot":{"x":0,"y":1}},{"members":[{"x":1,"y":0},{"x":0,"y":1},{"x":1,"y":1},{"x":1,"y":2},{"x":0,"y":3}],"pivot":{"x":0,"y":1}},{"members":[{"x":0,"y":3},{"x":0,"y":2},{"x":0,"y":0},{"x":1,"y":0},{"x":0,"y":1}],"pivot":{"x":0,"y":1}},{"members":[{"x":1,"y":0},{"x":0,"y":1},{"x":1,"y":2},{"x":0,"y":3},{"x":0,"y":4}],"pivot":{"x":0,"y":2}},{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":1,"y":1},{"x":1,"y":2},{"x":0,"y":3}],"pivot":{"x":0,"y":1}},{"members":[{"x":1,"y":4},{"x":0,"y":3},{"x":1,"y":0},{"x":1,"y":1},{"x":1,"y":2}],"pivot":{"x":0,"y":2}},{"members":[{"x":3,"y":0},{"x":2,"y":0},{"x":1,"y":1},{"x":0,"y":1},{"x":0,"y":2}],"pivot":{"x":1,"y":1}},{"members":[{"x":2,"y":0},{"x":2,"y":1},{"x":2,"y":2},{"x":1,"y":2},{"x":0,"y":3}],"pivot":{"x":1,"y":1}},{"members":[{"x":2,"y":2},{"x":1,"y":1},{"x":2,"y":0},{"x":0,"y":1},{"x":0,"y":2}],"pivot":{"x":1,"y":1}},{"members":[{"x":2,"y":2},{"x":2,"y":1},{"x":2,"y":0},{"x":1,"y":0},{"x":0,"y":1}],"pivot":{"x":1,"y":1}},{"members":[{"x":0,"y":0},{"x":0,"y":1},{"x":2,"y":2},{"x":1,"y":1},{"x":0,"y":2}],"pivot":{"x":1,"y":1}},{"members":[{"x":0,"y":1},{"x":1,"y":1},{"x":3,"y":1},{"x":3,"y":0},{"x":2,"y":0}],"pivot":{"x":1,"y":0}}],"id":2,"filled":[],"sourceLength":100},
	{"height":20,"width":30,"sourceSeeds":[0,29060,6876,31960,6094],"units":[{"members":[{"x":0,"y":0},{"x":2,"y":0}],"pivot":{"x":1,"y":0}},{"members":[{"x":1,"y":0},{"x":0,"y":1},{"x":0,"y":2}],"pivot":{"x":0,"y":1}},{"members":[{"x":2,"y":0},{"x":1,"y":0},{"x":0,"y":1}],"pivot":{"x":1,"y":0}},{"members":[{"x":1,"y":1},{"x":1,"y":0},{"x":0,"y":1}],"pivot":{"x":0,"y":0}},{"members":[{"x":2,"y":0},{"x":1,"y":1},{"x":1,"y":2},{"x":0,"y":3}],"pivot":{"x":1,"y":1}},{"members":[{"x":2,"y":0},{"x":1,"y":0},{"x":0,"y":1},{"x":0,"y":2}],"pivot":{"x":1,"y":1}},{"members":[{"x":1,"y":1},{"x":1,"y":0},{"x":0,"y":1},{"x":0,"y":2}],"pivot":{"x":0,"y":1}},{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":0,"y":1},{"x":0,"y":2}],"pivot":{"x":0,"y":1}},{"members":[{"x":1,"y":0},{"x":1,"y":1},{"x":1,"y":2},{"x":0,"y":3}],"pivot":{"x":0,"y":1}},{"members":[{"x":2,"y":0},{"x":1,"y":1},{"x":0,"y":1},{"x":0,"y":2}],"pivot":{"x":1,"y":1}},{"members":[{"x":2,"y":1},{"x":2,"y":0},{"x":1,"y":0},{"x":0,"y":1}],"pivot":{"x":1,"y":0}},{"members":[{"x":1,"y":1},{"x":2,"y":0},{"x":1,"y":0},{"x":0,"y":1}],"pivot":{"x":1,"y":0}},{"members":[{"x":0,"y":0},{"x":0,"y":1},{"x":1,"y":1},{"x":0,"y":2}],"pivot":{"x":0,"y":1}},{"members":[{"x":0,"y":1},{"x":1,"y":1},{"x":3,"y":0},{"x":2,"y":0}],"pivot":{"x":1,"y":0}}],"id":3,"filled":[{"x":2,"y":5},{"x":3,"y":5},{"x":4,"y":5},{"x":5,"y":5},{"x":11,"y":5},{"x":16,"y":5},{"x":17,"y":5},{"x":18,"y":5},{"x":19,"y":5},{"x":25,"y":5},{"x":4,"y":6},{"x":11,"y":6},{"x":18,"y":6},{"x":25,"y":6},{"x":4,"y":7},{"x":11,"y":7},{"x":18,"y":7},{"x":25,"y":7},{"x":4,"y":8},{"x":11,"y":8},{"x":18,"y":8},{"x":25,"y":8},{"x":4,"y":9},{"x":7,"y":9},{"x":8,"y":9},{"x":11,"y":9},{"x":18,"y":9},{"x":21,"y":9},{"x":22,"y":9},{"x":25,"y":9},{"x":4,"y":10},{"x":7,"y":10},{"x":9,"y":10},{"x":18,"y":10},{"x":21,"y":10},{"x":23,"y":10},{"x":2,"y":11},{"x":3,"y":11},{"x":4,"y":11},{"x":5,"y":11},{"x":7,"y":11},{"x":8,"y":11},{"x":9,"y":11},{"x":11,"y":11},{"x":16,"y":11},{"x":17,"y":11},{"x":18,"y":11},{"x":19,"y":11},{"x":21,"y":11},{"x":22,"y":11},{"x":23,"y":11},{"x":25,"y":11}],"sourceLength":100},
	{"height":15,"width":10,"sourceSeeds":[0,16868,32001,13661,12352,29707,19957,2584,21791,18451,17818,26137,7533,29971,2895,177,8466,17014,23414,23008,15766,6045,13537,31051,12140,26930,28921,8444,29697,8269,12976,28635,16520,22345,22572,12272,6532,2148,23344,19542,22290,2586,19530,11006,8700,30014,21695,26153,13694,20701],"units":[{"members":[{"x":1,"y":0},{"x":0,"y":0},{"x":2,"y":0},{"x":3,"y":0}],"pivot":{"x":1,"y":0}},{"members":[{"x":1,"y":1},{"x":0,"y":1},{"x":2,"y":1},{"x":3,"y":0}],"pivot":{"x":1,"y":1}},{"members":[{"x":1,"y":0},{"x":0,"y":0},{"x":2,"y":0},{"x":2,"y":1}],"pivot":{"x":1,"y":0}},{"members":[{"x":1,"y":1},{"x":0,"y":1},{"x":2,"y":1},{"x":2,"y":0}],"pivot":{"x":1,"y":1}},{"members":[{"x":1,"y":0},{"x":0,"y":0},{"x":2,"y":0},{"x":1,"y":1}],"pivot":{"x":1,"y":0}},{"members":[{"x":0,"y":1},{"x":0,"y":0},{"x":1,"y":1},{"x":2,"y":0}],"pivot":{"x":0,"y":1}},{"members":[{"x":1,"y":1},{"x":0,"y":1},{"x":2,"y":0},{"x":3,"y":0}],"pivot":{"x":1,"y":1}},{"members":[{"x":1,"y":0},{"x":0,"y":0},{"x":1,"y":1},{"x":2,"y":1}],"pivot":{"x":1,"y":0}},{"members":[{"x":1,"y":1},{"x":0,"y":1},{"x":1,"y":0},{"x":2,"y":0}],"pivot":{"x":1,"y":1}},{"members":[{"x":1,"y":1},{"x":0,"y":1},{"x":2,"y":0},{"x":2,"y":2}],"pivot":{"x":1,"y":1}}],"id":4,"filled":[],"sourceLength":200},
	{"height":20,"width":30,"sourceSeeds":[0,22837,22837,15215,24851,11460,14027,32620,32719,15577],"units":[{"members":[{"x":0,"y":0},{"x":2,"y":0}],"pivot":{"x":1,"y":0}},{"members":[{"x":1,"y":0},{"x":0,"y":1},{"x":0,"y":2}],"pivot":{"x":0,"y":1}},{"members":[{"x":2,"y":0},{"x":1,"y":0},{"x":0,"y":1}],"pivot":{"x":1,"y":0}},{"members":[{"x":1,"y":1},{"x":1,"y":0},{"x":0,"y":1}],"pivot":{"x":0,"y":0}},{"members":[{"x":2,"y":0},{"x":1,"y":1},{"x":1,"y":2},{"x":0,"y":3}],"pivot":{"x":1,"y":1}},{"members":[{"x":2,"y":0},{"x":1,"y":0},{"x":0,"y":1},{"x":0,"y":2}],"pivot":{"x":1,"y":1}},{"members":[{"x":1,"y":1},{"x":1,"y":0},{"x":0,"y":1},{"x":0,"y":2}],"pivot":{"x":0,"y":1}},{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":0,"y":1},{"x":0,"y":2}],"pivot":{"x":0,"y":1}},{"members":[{"x":1,"y":0},{"x":1,"y":1},{"x":1,"y":2},{"x":0,"y":3}],"pivot":{"x":0,"y":1}},{"members":[{"x":2,"y":0},{"x":1,"y":1},{"x":0,"y":1},{"x":0,"y":2}],"pivot":{"x":1,"y":1}},{"members":[{"x":2,"y":1},{"x":2,"y":0},{"x":1,"y":0},{"x":0,"y":1}],"pivot":{"x":1,"y":0}},{"members":[{"x":1,"y":1},{"x":2,"y":0},{"x":1,"y":0},{"x":0,"y":1}],"pivot":{"x":1,"y":0}},{"members":[{"x":0,"y":0},{"x":0,"y":1},{"x":1,"y":1},{"x":0,"y":2}],"pivot":{"x":0,"y":1}},{"members":[{"x":0,"y":1},{"x":1,"y":1},{"x":3,"y":0},{"x":2,"y":0}],"pivot":{"x":1,"y":0}}],"id":5,"filled":[{"x":2,"y":6},{"x":3,"y":6},{"x":4,"y":6},{"x":5,"y":6},{"x":8,"y":6},{"x":10,"y":6},{"x":22,"y":6},{"x":2,"y":7},{"x":5,"y":7},{"x":7,"y":7},{"x":10,"y":7},{"x":21,"y":7},{"x":2,"y":8},{"x":6,"y":8},{"x":8,"y":8},{"x":10,"y":8},{"x":22,"y":8},{"x":2,"y":9},{"x":3,"y":9},{"x":4,"y":9},{"x":5,"y":9},{"x":10,"y":9},{"x":12,"y":9},{"x":15,"y":9},{"x":17,"y":9},{"x":18,"y":9},{"x":19,"y":9},{"x":21,"y":9},{"x":2,"y":10},{"x":5,"y":10},{"x":10,"y":10},{"x":12,"y":10},{"x":15,"y":10},{"x":17,"y":10},{"x":20,"y":10},{"x":22,"y":10},{"x":23,"y":10},{"x":24,"y":10},{"x":2,"y":11},{"x":5,"y":11},{"x":10,"y":11},{"x":12,"y":11},{"x":14,"y":11},{"x":16,"y":11},{"x":17,"y":11},{"x":18,"y":11},{"x":19,"y":11},{"x":21,"y":11},{"x":24,"y":11},{"x":2,"y":12},{"x":6,"y":12},{"x":10,"y":12},{"x":13,"y":12},{"x":14,"y":12},{"x":17,"y":12},{"x":22,"y":12},{"x":25,"y":12},{"x":2,"y":13},{"x":6,"y":13},{"x":10,"y":13},{"x":13,"y":13},{"x":17,"y":13},{"x":18,"y":13},{"x":19,"y":13},{"x":21,"y":13},{"x":24,"y":13},{"x":13,"y":14},{"x":12,"y":15}],"sourceLength":100},
	{"height":10,"width":10,"sourceSeeds":[0,13120,18588,31026,7610,25460,23256,19086,24334,22079,9816,8466,3703,13185,26906,16903,24524,9536,11993,21728,2860,13859,21458,15379,10919,7082,26708,8123,18093,26670,16650,1519,15671,24732,16393,5343,28599,29169,8856,23220,25536,629,24513,14118,17013,6839,25499,17114,25267,8780],"units":[{"members":[{"x":0,"y":0}],"pivot":{"x":0,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0}],"pivot":{"x":0,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":2,"y":0}],"pivot":{"x":1,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":0,"y":1}],"pivot":{"x":0,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":1,"y":1}],"pivot":{"x":1,"y":0}}],"id":6,"filled":[],"sourceLength":150},
	{"height":20,"width":40,"sourceSeeds":[0,18705,22828,16651,27669],"units":[{"members":[{"x":0,"y":0},{"x":2,"y":0}],"pivot":{"x":1,"y":0}},{"members":[{"x":1,"y":0},{"x":0,"y":1},{"x":0,"y":2}],"pivot":{"x":0,"y":1}},{"members":[{"x":2,"y":0},{"x":1,"y":0},{"x":0,"y":1}],"pivot":{"x":1,"y":0}},{"members":[{"x":1,"y":1},{"x":1,"y":0},{"x":0,"y":1}],"pivot":{"x":0,"y":0}},{"members":[{"x":2,"y":0},{"x":1,"y":1},{"x":1,"y":2},{"x":0,"y":3}],"pivot":{"x":1,"y":1}},{"members":[{"x":2,"y":0},{"x":1,"y":0},{"x":0,"y":1},{"x":0,"y":2}],"pivot":{"x":1,"y":1}},{"members":[{"x":1,"y":1},{"x":1,"y":0},{"x":0,"y":1},{"x":0,"y":2}],"pivot":{"x":0,"y":1}},{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":0,"y":1},{"x":0,"y":2}],"pivot":{"x":0,"y":1}},{"members":[{"x":1,"y":0},{"x":1,"y":1},{"x":1,"y":2},{"x":0,"y":3}],"pivot":{"x":0,"y":1}},{"members":[{"x":2,"y":0},{"x":1,"y":1},{"x":0,"y":1},{"x":0,"y":2}],"pivot":{"x":1,"y":1}},{"members":[{"x":2,"y":1},{"x":2,"y":0},{"x":1,"y":0},{"x":0,"y":1}],"pivot":{"x":1,"y":0}},{"members":[{"x":1,"y":1},{"x":2,"y":0},{"x":1,"y":0},{"x":0,"y":1}],"pivot":{"x":1,"y":0}},{"members":[{"x":0,"y":0},{"x":0,"y":1},{"x":1,"y":1},{"x":0,"y":2}],"pivot":{"x":0,"y":1}},{"members":[{"x":0,"y":1},{"x":1,"y":1},{"x":3,"y":0},{"x":2,"y":0}],"pivot":{"x":1,"y":0}}],"id":7,"filled":[{"x":0,"y":5},{"x":4,"y":5},{"x":30,"y":5},{"x":34,"y":5},{"x":1,"y":6},{"x":4,"y":6},{"x":30,"y":6},{"x":34,"y":6},{"x":1,"y":7},{"x":3,"y":7},{"x":30,"y":7},{"x":34,"y":7},{"x":2,"y":8},{"x":3,"y":8},{"x":29,"y":8},{"x":30,"y":8},{"x":31,"y":8},{"x":32,"y":8},{"x":34,"y":8},{"x":2,"y":9},{"x":5,"y":9},{"x":9,"y":9},{"x":12,"y":9},{"x":13,"y":9},{"x":14,"y":9},{"x":18,"y":9},{"x":19,"y":9},{"x":20,"y":9},{"x":24,"y":9},{"x":25,"y":9},{"x":26,"y":9},{"x":30,"y":9},{"x":34,"y":9},{"x":35,"y":9},{"x":36,"y":9},{"x":2,"y":10},{"x":6,"y":10},{"x":9,"y":10},{"x":12,"y":10},{"x":15,"y":10},{"x":18,"y":10},{"x":21,"y":10},{"x":24,"y":10},{"x":27,"y":10},{"x":30,"y":10},{"x":34,"y":10},{"x":37,"y":10},{"x":2,"y":11},{"x":5,"y":11},{"x":9,"y":11},{"x":11,"y":11},{"x":15,"y":11},{"x":17,"y":11},{"x":21,"y":11},{"x":23,"y":11},{"x":27,"y":11},{"x":30,"y":11},{"x":34,"y":11},{"x":37,"y":11},{"x":2,"y":12},{"x":6,"y":12},{"x":9,"y":12},{"x":12,"y":12},{"x":15,"y":12},{"x":18,"y":12},{"x":21,"y":12},{"x":24,"y":12},{"x":27,"y":12},{"x":30,"y":12},{"x":34,"y":12},{"x":37,"y":12},{"x":2,"y":13},{"x":6,"y":13},{"x":7,"y":13},{"x":8,"y":13},{"x":12,"y":13},{"x":13,"y":13},{"x":14,"y":13},{"x":15,"y":13},{"x":18,"y":13},{"x":19,"y":13},{"x":20,"y":13},{"x":21,"y":13},{"x":24,"y":13},{"x":25,"y":13},{"x":26,"y":13},{"x":30,"y":13},{"x":31,"y":13},{"x":34,"y":13},{"x":37,"y":13},{"x":15,"y":14},{"x":21,"y":14},{"x":14,"y":15},{"x":20,"y":15},{"x":12,"y":16},{"x":13,"y":16},{"x":14,"y":16},{"x":18,"y":16},{"x":19,"y":16},{"x":20,"y":16}],"sourceLength":100},
	{"height":8,"width":10,"sourceSeeds":[0,28581,10596,4491,19012,8000,14104,20240,2629,5696],"units":[{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":2,"y":0},{"x":3,"y":0}],"pivot":{"x":1,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":0,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":0,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":0,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":0,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":0,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":0,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":0,"y":0}}],"id":8,"filled":[],"sourceLength":400},
	{"height":8,"width":10,"sourceSeeds":[0,26637,10998,4150,23855],"units":[{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":2,"y":0},{"x":3,"y":0}],"pivot":{"x":1,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":2,"y":0}],"pivot":{"x":1,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":2,"y":0}],"pivot":{"x":1,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":2,"y":0}],"pivot":{"x":1,"y":0}}],"id":9,"filled":[{"x":0,"y":3},{"x":1,"y":3},{"x":2,"y":3},{"x":3,"y":3},{"x":4,"y":3},{"x":5,"y":3}],"sourceLength":400},
	{"height":7,"width":10,"sourceSeeds":[0],"units":[{"members":[{"x":2,"y":0},{"x":3,"y":0}],"pivot":{"x":0,"y":0}}],"id":10,"filled":[{"x":0,"y":1},{"x":2,"y":1},{"x":4,"y":1},{"x":6,"y":1},{"x":8,"y":1},{"x":1,"y":5},{"x":2,"y":5},{"x":3,"y":5},{"x":4,"y":5},{"x":5,"y":5},{"x":6,"y":5},{"x":7,"y":5},{"x":8,"y":5}],"sourceLength":100},
	{"height":10,"width":10,"sourceSeeds":[0,12877,20528,16526,19558],"units":[{"members":[{"x":0,"y":0}],"pivot":{"x":2,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":2,"y":0}},{"members":[{"x":1,"y":0},{"x":2,"y":0},{"x":0,"y":1},{"x":2,"y":1},{"x":1,"y":2},{"x":2,"y":2}],"pivot":{"x":1,"y":1}}],"id":11,"filled":[],"sourceLength":50},
	{"height":20,"width":15,"sourceSeeds":[0,24762,24103,12700,5864,1155,24803,29992,18660,19102],"units":[{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":1,"y":0},{"x":2,"y":0},{"x":0,"y":1},{"x":2,"y":1},{"x":1,"y":2},{"x":2,"y":2}],"pivot":{"x":3,"y":5}},{"members":[{"x":1,"y":0},{"x":2,"y":0},{"x":0,"y":1},{"x":2,"y":1},{"x":1,"y":2},{"x":2,"y":2}],"pivot":{"x":3,"y":5}},{"members":[{"x":1,"y":0},{"x":2,"y":0},{"x":3,"y":0},{"x":0,"y":1},{"x":3,"y":1},{"x":0,"y":2},{"x":4,"y":2},{"x":0,"y":3},{"x":3,"y":3},{"x":1,"y":4},{"x":2,"y":4},{"x":3,"y":4}],"pivot":{"x":8,"y":6}}],"id":12,"filled":[],"sourceLength":100},
	{"height":20,"width":15,"sourceSeeds":[0],"units":[{"members":[{"x":1,"y":0},{"x":2,"y":0},{"x":3,"y":0},{"x":0,"y":1},{"x":1,"y":1},{"x":2,"y":1},{"x":3,"y":1},{"x":0,"y":2},{"x":2,"y":2},{"x":4,"y":2},{"x":0,"y":3},{"x":1,"y":3},{"x":2,"y":3},{"x":3,"y":3},{"x":0,"y":4},{"x":2,"y":4},{"x":4,"y":4}],"pivot":{"x":2,"y":2}}],"id":13,"filled":[],"sourceLength":100},
	{"height":50,"width":50,"sourceSeeds":[0],"units":[{"members":[{"x":0,"y":0}],"pivot":{"x":0,"y":0}},{"members":[{"x":0,"y":0},{"x":2,"y":0}],"pivot":{"x":1,"y":0}},{"members":[{"x":2,"y":0},{"x":0,"y":1},{"x":2,"y":2}],"pivot":{"x":1,"y":1}}],"id":14,"filled":[{"x":21,"y":5},{"x":22,"y":5},{"x":23,"y":5},{"x":24,"y":5},{"x":25,"y":5},{"x":26,"y":5},{"x":27,"y":5},{"x":28,"y":5},{"x":19,"y":6},{"x":20,"y":6},{"x":21,"y":6},{"x":29,"y":6},{"x":30,"y":6},{"x":31,"y":6},{"x":17,"y":7},{"x":18,"y":7},{"x":31,"y":7},{"x":32,"y":7},{"x":16,"y":8},{"x":17,"y":8},{"x":33,"y":8},{"x":15,"y":9},{"x":16,"y":9},{"x":33,"y":9},{"x":34,"y":9},{"x":14,"y":10},{"x":15,"y":10},{"x":16,"y":10},{"x":17,"y":10},{"x":18,"y":10},{"x":33,"y":10},{"x":34,"y":10},{"x":35,"y":10},{"x":36,"y":10},{"x":12,"y":11},{"x":13,"y":11},{"x":16,"y":11},{"x":18,"y":11},{"x":19,"y":11},{"x":32,"y":11},{"x":33,"y":11},{"x":36,"y":11},{"x":12,"y":12},{"x":16,"y":12},{"x":20,"y":12},{"x":21,"y":12},{"x":31,"y":12},{"x":32,"y":12},{"x":34,"y":12},{"x":37,"y":12},{"x":38,"y":12},{"x":11,"y":13},{"x":16,"y":13},{"x":21,"y":13},{"x":29,"y":13},{"x":30,"y":13},{"x":33,"y":13},{"x":38,"y":13},{"x":11,"y":14},{"x":17,"y":14},{"x":22,"y":14},{"x":23,"y":14},{"x":28,"y":14},{"x":29,"y":14},{"x":33,"y":14},{"x":39,"y":14},{"x":10,"y":15},{"x":17,"y":15},{"x":23,"y":15},{"x":24,"y":15},{"x":26,"y":15},{"x":27,"y":15},{"x":32,"y":15},{"x":39,"y":15},{"x":10,"y":16},{"x":17,"y":16},{"x":25,"y":16},{"x":26,"y":16},{"x":32,"y":16},{"x":40,"y":16},{"x":9,"y":17},{"x":17,"y":17},{"x":24,"y":17},{"x":26,"y":17},{"x":32,"y":17},{"x":40,"y":17},{"x":9,"y":18},{"x":18,"y":18},{"x":23,"y":18},{"x":24,"y":18},{"x":27,"y":18},{"x":28,"y":18},{"x":32,"y":18},{"x":41,"y":18},{"x":9,"y":19},{"x":18,"y":19},{"x":21,"y":19},{"x":22,"y":19},{"x":28,"y":19},{"x":29,"y":19},{"x":31,"y":19},{"x":41,"y":19},{"x":9,"y":20},{"x":19,"y":20},{"x":20,"y":20},{"x":21,"y":20},{"x":30,"y":20},{"x":31,"y":20},{"x":41,"y":20},{"x":9,"y":21},{"x":18,"y":21},{"x":19,"y":21},{"x":30,"y":21},{"x":31,"y":21},{"x":41,"y":21},{"x":9,"y":22},{"x":18,"y":22},{"x":19,"y":22},{"x":31,"y":22},{"x":32,"y":22},{"x":33,"y":22},{"x":41,"y":22},{"x":8,"y":23},{"x":16,"y":23},{"x":17,"y":23},{"x":19,"y":23},{"x":30,"y":23},{"x":33,"y":23},{"x":41,"y":23},{"x":9,"y":24},{"x":16,"y":24},{"x":20,"y":24},{"x":30,"y":24},{"x":34,"y":24},{"x":35,"y":24},{"x":41,"y":24},{"x":8,"y":25},{"x":14,"y":25},{"x":15,"y":25},{"x":20,"y":25},{"x":29,"y":25},{"x":35,"y":25},{"x":36,"y":25},{"x":41,"y":25},{"x":9,"y":26},{"x":13,"y":26},{"x":14,"y":26},{"x":20,"y":26},{"x":29,"y":26},{"x":37,"y":26},{"x":41,"y":26},{"x":9,"y":27},{"x":11,"y":27},{"x":12,"y":27},{"x":20,"y":27},{"x":29,"y":27},{"x":37,"y":27},{"x":38,"y":27},{"x":40,"y":27},{"x":9,"y":28},{"x":11,"y":28},{"x":21,"y":28},{"x":29,"y":28},{"x":39,"y":28},{"x":40,"y":28},{"x":9,"y":29},{"x":10,"y":29},{"x":11,"y":29},{"x":12,"y":29},{"x":13,"y":29},{"x":14,"y":29},{"x":15,"y":29},{"x":16,"y":29},{"x":17,"y":29},{"x":18,"y":29},{"x":19,"y":29},{"x":20,"y":29},{"x":21,"y":29},{"x":22,"y":29},{"x":23,"y":29},{"x":24,"y":29},{"x":25,"y":29},{"x":26,"y":29},{"x":27,"y":29},{"x":28,"y":29},{"x":29,"y":29},{"x":30,"y":29},{"x":31,"y":29},{"x":32,"y":29},{"x":33,"y":29},{"x":34,"y":29},{"x":35,"y":29},{"x":36,"y":29},{"x":37,"y":29},{"x":38,"y":29},{"x":39,"y":29},{"x":40,"y":29},{"x":10,"y":30},{"x":21,"y":30},{"x":28,"y":30},{"x":40,"y":30},{"x":10,"y":31},{"x":21,"y":31},{"x":28,"y":31},{"x":40,"y":31},{"x":11,"y":32},{"x":22,"y":32},{"x":28,"y":32},{"x":40,"y":32},{"x":11,"y":33},{"x":22,"y":33},{"x":27,"y":33},{"x":38,"y":33},{"x":39,"y":33},{"x":12,"y":34},{"x":22,"y":34},{"x":27,"y":34},{"x":39,"y":34},{"x":12,"y":35},{"x":22,"y":35},{"x":26,"y":35},{"x":38,"y":35},{"x":13,"y":36},{"x":23,"y":36},{"x":27,"y":36},{"x":37,"y":36},{"x":38,"y":36},{"x":13,"y":37},{"x":23,"y":37},{"x":26,"y":37},{"x":36,"y":37},{"x":14,"y":38},{"x":15,"y":38},{"x":24,"y":38},{"x":26,"y":38},{"x":35,"y":38},{"x":36,"y":38},{"x":15,"y":39},{"x":24,"y":39},{"x":25,"y":39},{"x":34,"y":39},{"x":16,"y":40},{"x":17,"y":40},{"x":18,"y":40},{"x":24,"y":40},{"x":25,"y":40},{"x":32,"y":40},{"x":33,"y":40},{"x":34,"y":40},{"x":18,"y":41},{"x":19,"y":41},{"x":20,"y":41},{"x":24,"y":41},{"x":29,"y":41},{"x":30,"y":41},{"x":31,"y":41},{"x":21,"y":42},{"x":22,"y":42},{"x":23,"y":42},{"x":24,"y":42},{"x":25,"y":42},{"x":26,"y":42},{"x":27,"y":42},{"x":28,"y":42},{"x":29,"y":42}],"sourceLength":500},
	{"height":20,"width":15,"sourceSeeds":[0],"units":[{"members":[{"x":0,"y":0},{"x":2,"y":0},{"x":0,"y":2},{"x":2,"y":2}],"pivot":{"x":1,"y":1}}],"id":15,"filled":[],"sourceLength":100},
	{"height":20,"width":15,"sourceSeeds":[0],"units":[{"members":[{"x":0,"y":0}],"pivot":{"x":0,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0}],"pivot":{"x":0,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":2,"y":0}],"pivot":{"x":1,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":0,"y":1}],"pivot":{"x":0,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":1,"y":1}],"pivot":{"x":1,"y":0}}],"id":16,"filled":[{"x":0,"y":9},{"x":0,"y":18},{"x":0,"y":19},{"x":1,"y":9},{"x":1,"y":18},{"x":2,"y":6},{"x":2,"y":12},{"x":2,"y":16},{"x":3,"y":5},{"x":3,"y":8},{"x":3,"y":11},{"x":4,"y":9},{"x":4,"y":10},{"x":4,"y":16},{"x":4,"y":18},{"x":5,"y":9},{"x":5,"y":14},{"x":5,"y":19},{"x":6,"y":17},{"x":7,"y":6},{"x":7,"y":13},{"x":8,"y":6},{"x":8,"y":8},{"x":8,"y":14},{"x":9,"y":10},{"x":9,"y":11},{"x":10,"y":10},{"x":10,"y":12},{"x":10,"y":15},{"x":10,"y":18},{"x":11,"y":5},{"x":12,"y":7},{"x":12,"y":8},{"x":13,"y":8},{"x":13,"y":11},{"x":13,"y":18},{"x":14,"y":10}],"sourceLength":100},
	{"height":15,"width":15,"sourceSeeds":[0],"units":[{"members":[{"x":0,"y":0}],"pivot":{"x":0,"y":0}}],"id":17,"filled":[{"x":0,"y":8},{"x":1,"y":8},{"x":2,"y":8},{"x":3,"y":8},{"x":5,"y":8},{"x":6,"y":8},{"x":7,"y":8},{"x":8,"y":8},{"x":9,"y":8},{"x":10,"y":8},{"x":11,"y":8},{"x":12,"y":8},{"x":13,"y":8},{"x":14,"y":8},{"x":0,"y":9},{"x":1,"y":9},{"x":2,"y":9},{"x":3,"y":9},{"x":4,"y":9},{"x":5,"y":9},{"x":6,"y":9},{"x":7,"y":9},{"x":8,"y":9},{"x":9,"y":9},{"x":10,"y":9},{"x":11,"y":9},{"x":12,"y":9},{"x":14,"y":9},{"x":0,"y":10},{"x":2,"y":10},{"x":3,"y":10},{"x":4,"y":10},{"x":5,"y":10},{"x":6,"y":10},{"x":7,"y":10},{"x":8,"y":10},{"x":9,"y":10},{"x":10,"y":10},{"x":11,"y":10},{"x":12,"y":10},{"x":13,"y":10},{"x":14,"y":10},{"x":0,"y":11},{"x":1,"y":11},{"x":2,"y":11},{"x":3,"y":11},{"x":4,"y":11},{"x":5,"y":11},{"x":7,"y":11},{"x":8,"y":11},{"x":9,"y":11},{"x":10,"y":11},{"x":11,"y":11},{"x":12,"y":11},{"x":13,"y":11},{"x":14,"y":11},{"x":0,"y":12},{"x":1,"y":12},{"x":2,"y":12},{"x":4,"y":12},{"x":5,"y":12},{"x":6,"y":12},{"x":7,"y":12},{"x":8,"y":12},{"x":9,"y":12},{"x":10,"y":12},{"x":11,"y":12},{"x":12,"y":12},{"x":13,"y":12},{"x":14,"y":12},{"x":0,"y":13},{"x":1,"y":13},{"x":2,"y":13},{"x":3,"y":13},{"x":4,"y":13},{"x":5,"y":13},{"x":6,"y":13},{"x":7,"y":13},{"x":8,"y":13},{"x":9,"y":13},{"x":10,"y":13},{"x":11,"y":13},{"x":13,"y":13},{"x":14,"y":13},{"x":0,"y":14},{"x":1,"y":14},{"x":2,"y":14},{"x":3,"y":14},{"x":4,"y":14},{"x":5,"y":14},{"x":6,"y":14},{"x":7,"y":14},{"x":8,"y":14},{"x":9,"y":14},{"x":10,"y":14},{"x":11,"y":14},{"x":12,"y":14},{"x":13,"y":14}],"sourceLength":100},
	{"height":30,"width":30,"sourceSeeds":[0],"units":[{"members":[{"x":0,"y":0}],"pivot":{"x":0,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":0,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":0,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":0,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":0,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":0,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":0,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":0,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":0,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":0,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":3,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":3,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":3,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":3,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":3,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":3,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":3,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":3,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":3,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":3,"y":0}},{"members":[{"x":1,"y":0},{"x":2,"y":0},{"x":3,"y":0},{"x":0,"y":1},{"x":1,"y":1},{"x":2,"y":1},{"x":3,"y":1},{"x":0,"y":2},{"x":2,"y":2},{"x":4,"y":2},{"x":0,"y":3},{"x":1,"y":3},{"x":2,"y":3},{"x":3,"y":3},{"x":0,"y":4},{"x":2,"y":4},{"x":4,"y":4}],"pivot":{"x":2,"y":2}},{"members":[{"x":1,"y":0},{"x":1,"y":1},{"x":2,"y":2},{"x":1,"y":3},{"x":2,"y":3},{"x":1,"y":4},{"x":3,"y":4},{"x":0,"y":5},{"x":3,"y":5}],"pivot":{"x":2,"y":2}},{"members":[{"x":1,"y":0},{"x":1,"y":1},{"x":2,"y":2},{"x":1,"y":3},{"x":2,"y":3},{"x":1,"y":4},{"x":3,"y":4},{"x":0,"y":5},{"x":3,"y":5}],"pivot":{"x":2,"y":2}},{"members":[{"x":1,"y":0},{"x":1,"y":1},{"x":2,"y":2},{"x":1,"y":3},{"x":2,"y":3},{"x":1,"y":4},{"x":3,"y":4},{"x":0,"y":5},{"x":3,"y":5}],"pivot":{"x":2,"y":2}},{"members":[{"x":1,"y":0},{"x":1,"y":1},{"x":2,"y":2},{"x":1,"y":3},{"x":2,"y":3},{"x":1,"y":4},{"x":3,"y":4},{"x":0,"y":5},{"x":3,"y":5}],"pivot":{"x":2,"y":2}},{"members":[{"x":1,"y":0},{"x":1,"y":1},{"x":2,"y":2},{"x":1,"y":3},{"x":2,"y":3},{"x":1,"y":4},{"x":3,"y":4},{"x":0,"y":5},{"x":3,"y":5}],"pivot":{"x":2,"y":2}}],"id":18,"filled":[{"x":9,"y":6},{"x":12,"y":6},{"x":6,"y":7},{"x":7,"y":7},{"x":8,"y":7},{"x":9,"y":7},{"x":10,"y":7},{"x":11,"y":7},{"x":13,"y":7},{"x":15,"y":7},{"x":4,"y":8},{"x":5,"y":8},{"x":6,"y":8},{"x":7,"y":8},{"x":8,"y":8},{"x":9,"y":8},{"x":10,"y":8},{"x":11,"y":8},{"x":12,"y":8},{"x":13,"y":8},{"x":14,"y":8},{"x":15,"y":8},{"x":5,"y":9},{"x":6,"y":9},{"x":8,"y":9},{"x":10,"y":9},{"x":11,"y":9},{"x":12,"y":9},{"x":13,"y":9},{"x":14,"y":9},{"x":15,"y":9},{"x":16,"y":9},{"x":21,"y":9},{"x":22,"y":9},{"x":24,"y":9},{"x":26,"y":9},{"x":27,"y":9},{"x":7,"y":10},{"x":8,"y":10},{"x":9,"y":10},{"x":10,"y":10},{"x":11,"y":10},{"x":16,"y":10},{"x":23,"y":10},{"x":24,"y":10},{"x":25,"y":10},{"x":26,"y":10},{"x":27,"y":10},{"x":28,"y":10},{"x":29,"y":10},{"x":24,"y":11},{"x":26,"y":11},{"x":27,"y":11},{"x":10,"y":21},{"x":14,"y":21},{"x":18,"y":21},{"x":10,"y":22},{"x":15,"y":22},{"x":19,"y":22},{"x":3,"y":23},{"x":9,"y":23},{"x":10,"y":23},{"x":14,"y":23},{"x":19,"y":23},{"x":26,"y":23},{"x":3,"y":24},{"x":4,"y":24},{"x":9,"y":24},{"x":10,"y":24},{"x":14,"y":24},{"x":15,"y":24},{"x":19,"y":24},{"x":20,"y":24},{"x":23,"y":24},{"x":26,"y":24},{"x":2,"y":25},{"x":3,"y":25},{"x":4,"y":25},{"x":8,"y":25},{"x":9,"y":25},{"x":14,"y":25},{"x":19,"y":25},{"x":20,"y":25},{"x":22,"y":25},{"x":23,"y":25},{"x":25,"y":25},{"x":26,"y":25},{"x":2,"y":26},{"x":3,"y":26},{"x":4,"y":26},{"x":5,"y":26},{"x":8,"y":26},{"x":9,"y":26},{"x":11,"y":26},{"x":14,"y":26},{"x":15,"y":26},{"x":20,"y":26},{"x":21,"y":26},{"x":23,"y":26},{"x":24,"y":26},{"x":25,"y":26},{"x":26,"y":26},{"x":28,"y":26},{"x":29,"y":26},{"x":0,"y":27},{"x":1,"y":27},{"x":3,"y":27},{"x":5,"y":27},{"x":6,"y":27},{"x":8,"y":27},{"x":9,"y":27},{"x":10,"y":27},{"x":11,"y":27},{"x":12,"y":27},{"x":13,"y":27},{"x":14,"y":27},{"x":17,"y":27},{"x":18,"y":27},{"x":20,"y":27},{"x":21,"y":27},{"x":22,"y":27},{"x":23,"y":27},{"x":24,"y":27},{"x":25,"y":27},{"x":26,"y":27},{"x":27,"y":27},{"x":29,"y":27},{"x":0,"y":28},{"x":1,"y":28},{"x":2,"y":28},{"x":3,"y":28},{"x":4,"y":28},{"x":5,"y":28},{"x":6,"y":28},{"x":8,"y":28},{"x":9,"y":28},{"x":10,"y":28},{"x":11,"y":28},{"x":12,"y":28},{"x":13,"y":28},{"x":14,"y":28},{"x":15,"y":28},{"x":16,"y":28},{"x":17,"y":28},{"x":19,"y":28},{"x":20,"y":28},{"x":21,"y":28},{"x":22,"y":28},{"x":23,"y":28},{"x":24,"y":28},{"x":26,"y":28},{"x":27,"y":28},{"x":28,"y":28},{"x":29,"y":28},{"x":0,"y":29},{"x":1,"y":29},{"x":2,"y":29},{"x":3,"y":29},{"x":4,"y":29},{"x":5,"y":29},{"x":6,"y":29},{"x":7,"y":29},{"x":9,"y":29},{"x":11,"y":29},{"x":12,"y":29},{"x":14,"y":29},{"x":16,"y":29},{"x":18,"y":29},{"x":19,"y":29},{"x":21,"y":29},{"x":22,"y":29},{"x":23,"y":29},{"x":24,"y":29},{"x":25,"y":29},{"x":26,"y":29},{"x":27,"y":29},{"x":28,"y":29},{"x":29,"y":29}],"sourceLength":1000},
	{"height":15,"width":15,"sourceSeeds":[0],"units":[{"members":[{"x":0,"y":0}],"pivot":{"x":0,"y":0}}],"id":19,"filled":[{"x":0,"y":8},{"x":1,"y":8},{"x":2,"y":8},{"x":6,"y":8},{"x":7,"y":8},{"x":8,"y":8},{"x":9,"y":8},{"x":10,"y":8},{"x":11,"y":8},{"x":12,"y":8},{"x":13,"y":8},{"x":14,"y":8},{"x":0,"y":9},{"x":1,"y":9},{"x":2,"y":9},{"x":3,"y":9},{"x":7,"y":9},{"x":8,"y":9},{"x":9,"y":9},{"x":10,"y":9},{"x":11,"y":9},{"x":12,"y":9},{"x":13,"y":9},{"x":14,"y":9},{"x":0,"y":10},{"x":1,"y":10},{"x":2,"y":10},{"x":3,"y":10},{"x":4,"y":10},{"x":5,"y":10},{"x":9,"y":10},{"x":10,"y":10},{"x":11,"y":10},{"x":12,"y":10},{"x":13,"y":10},{"x":14,"y":10},{"x":0,"y":11},{"x":1,"y":11},{"x":2,"y":11},{"x":3,"y":11},{"x":7,"y":11},{"x":8,"y":11},{"x":9,"y":11},{"x":10,"y":11},{"x":11,"y":11},{"x":12,"y":11},{"x":13,"y":11},{"x":14,"y":11},{"x":0,"y":12},{"x":1,"y":12},{"x":2,"y":12},{"x":3,"y":12},{"x":4,"y":12},{"x":8,"y":12},{"x":9,"y":12},{"x":10,"y":12},{"x":11,"y":12},{"x":12,"y":12},{"x":13,"y":12},{"x":14,"y":12},{"x":0,"y":13},{"x":1,"y":13},{"x":2,"y":13},{"x":6,"y":13},{"x":7,"y":13},{"x":8,"y":13},{"x":9,"y":13},{"x":10,"y":13},{"x":11,"y":13},{"x":12,"y":13},{"x":13,"y":13},{"x":14,"y":13},{"x":0,"y":14},{"x":1,"y":14},{"x":2,"y":14},{"x":6,"y":14},{"x":7,"y":14},{"x":8,"y":14},{"x":9,"y":14},{"x":10,"y":14},{"x":11,"y":14},{"x":12,"y":14},{"x":13,"y":14},{"x":14,"y":14}],"sourceLength":100},
	{"height":15,"width":15,"sourceSeeds":[0],"units":[{"members":[{"x":0,"y":0},{"x":2,"y":0}],"pivot":{"x":1,"y":5}},{"members":[{"x":0,"y":0},{"x":0,"y":2}],"pivot":{"x":0,"y":6}},{"members":[{"x":2,"y":0},{"x":0,"y":1},{"x":2,"y":2}],"pivot":{"x":1,"y":6}},{"members":[{"x":0,"y":0},{"x":1,"y":1},{"x":0,"y":2}],"pivot":{"x":0,"y":6}}],"id":20,"filled":[],"sourceLength":100},
	{"height":8,"width":10,"sourceSeeds":[0],"units":[{"members":[{"x":0,"y":0}],"pivot":{"x":0,"y":0}}],"id":21,"filled":[{"x":1,"y":2},{"x":2,"y":2},{"x":3,"y":3},{"x":4,"y":3},{"x":3,"y":2},{"x":4,"y":2},{"x":5,"y":3},{"x":6,"y":3},{"x":5,"y":2},{"x":6,"y":2},{"x":7,"y":3},{"x":8,"y":3},{"x":7,"y":2},{"x":8,"y":2},{"x":9,"y":3},{"x":1,"y":4},{"x":2,"y":4},{"x":3,"y":5},{"x":4,"y":5},{"x":3,"y":4},{"x":4,"y":4},{"x":5,"y":5},{"x":6,"y":5},{"x":5,"y":4},{"x":6,"y":4},{"x":7,"y":5},{"x":8,"y":5},{"x":7,"y":4},{"x":8,"y":4},{"x":9,"y":5},{"x":1,"y":6},{"x":2,"y":6},{"x":3,"y":7},{"x":4,"y":7},{"x":3,"y":6},{"x":4,"y":6},{"x":5,"y":7},{"x":6,"y":7},{"x":5,"y":6},{"x":6,"y":6},{"x":7,"y":7},{"x":8,"y":7},{"x":7,"y":6},{"x":8,"y":6},{"x":9,"y":7}],"sourceLength":20},
	{"height":8,"width":10,"sourceSeeds":[0],"units":[{"members":[{"x":0,"y":0},{"x":1,"y":0}],"pivot":{"x":0,"y":0}}],"id":22,"filled":[{"x":1,"y":2},{"x":2,"y":2},{"x":3,"y":3},{"x":4,"y":3},{"x":3,"y":2},{"x":4,"y":2},{"x":5,"y":3},{"x":6,"y":3},{"x":5,"y":2},{"x":6,"y":2},{"x":7,"y":3},{"x":8,"y":3},{"x":7,"y":2},{"x":8,"y":2},{"x":9,"y":3},{"x":1,"y":4},{"x":2,"y":4},{"x":3,"y":5},{"x":4,"y":5},{"x":3,"y":4},{"x":4,"y":4},{"x":5,"y":5},{"x":6,"y":5},{"x":5,"y":4},{"x":6,"y":4},{"x":7,"y":5},{"x":8,"y":5},{"x":7,"y":4},{"x":8,"y":4},{"x":9,"y":5},{"x":1,"y":6},{"x":2,"y":6},{"x":3,"y":7},{"x":4,"y":7},{"x":3,"y":6},{"x":4,"y":6},{"x":5,"y":7},{"x":6,"y":7},{"x":5,"y":6},{"x":6,"y":6},{"x":7,"y":7},{"x":8,"y":7},{"x":7,"y":6},{"x":8,"y":6},{"x":9,"y":7}],"sourceLength":100},
	{"height":9,"width":10,"sourceSeeds":[0],"units":[{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":2,"y":0}],"pivot":{"x":1,"y":0}}],"id":23,"filled":[{"x":1,"y":3},{"x":2,"y":3},{"x":3,"y":3},{"x":4,"y":3},{"x":5,"y":3},{"x":6,"y":3},{"x":7,"y":3},{"x":8,"y":3},{"x":1,"y":5},{"x":2,"y":5},{"x":3,"y":5},{"x":4,"y":5},{"x":5,"y":5},{"x":6,"y":5},{"x":7,"y":5},{"x":8,"y":5},{"x":1,"y":7},{"x":2,"y":7},{"x":3,"y":7},{"x":4,"y":7},{"x":5,"y":7},{"x":6,"y":7},{"x":7,"y":7},{"x":8,"y":7}],"sourceLength":100},
	{"height":40,"width":100,"sourceSeeds":[18],"units":[{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":2,"y":0},{"x":3,"y":0},{"x":1,"y":1},{"x":1,"y":2},{"x":1,"y":3},{"x":0,"y":4},{"x":1,"y":4},{"x":2,"y":4},{"x":3,"y":4}],"pivot":{"x":2,"y":2}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":2,"y":0},{"x":2,"y":1},{"x":1,"y":2},{"x":2,"y":2},{"x":0,"y":3},{"x":0,"y":4},{"x":1,"y":4},{"x":2,"y":4},{"x":3,"y":4}],"pivot":{"x":2,"y":2}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":1,"y":0},{"x":2,"y":0},{"x":3,"y":0},{"x":0,"y":1},{"x":0,"y":2},{"x":0,"y":3},{"x":1,"y":4},{"x":2,"y":4},{"x":3,"y":4}],"pivot":{"x":2,"y":2}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":2,"y":0},{"x":0,"y":1},{"x":0,"y":2},{"x":1,"y":2},{"x":2,"y":2},{"x":0,"y":3},{"x":0,"y":4}],"pivot":{"x":1,"y":3}},{"members":[{"x":0,"y":0},{"x":1,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":2,"y":0},{"x":3,"y":0},{"x":0,"y":1},{"x":1,"y":2},{"x":2,"y":2},{"x":3,"y":2},{"x":3,"y":3},{"x":0,"y":4},{"x":1,"y":4},{"x":2,"y":4},{"x":3,"y":4}],"pivot":{"x":2,"y":2}},{"members":[{"x":0,"y":0},{"x":1,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":2,"y":0},{"x":3,"y":0},{"x":2,"y":1},{"x":2,"y":2},{"x":1,"y":3},{"x":0,"y":4},{"x":1,"y":4},{"x":2,"y":4},{"x":3,"y":4}],"pivot":{"x":2,"y":2}},{"members":[{"x":0,"y":0},{"x":1,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":2,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":2,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":2,"y":0},{"x":0,"y":1},{"x":2,"y":1},{"x":0,"y":2},{"x":1,"y":2},{"x":2,"y":2},{"x":0,"y":3},{"x":0,"y":4}],"pivot":{"x":1,"y":2}},{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":2,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":2,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":2,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":2,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":0,"y":0},{"x":1,"y":0},{"x":2,"y":0}],"pivot":{"x":4,"y":0}},{"members":[{"x":1,"y":0},{"x":2,"y":0},{"x":3,"y":0},{"x":0,"y":1},{"x":3,"y":1},{"x":0,"y":2},{"x":4,"y":2},{"x":0,"y":3},{"x":3,"y":3},{"x":1,"y":4},{"x":2,"y":4},{"x":3,"y":4},{"x":2,"y":2}],"pivot":{"x":2,"y":2}}],"id":24,"filled":[{"x":14,"y":10},{"x":13,"y":11},{"x":14,"y":12},{"x":13,"y":13},{"x":14,"y":14},{"x":13,"y":15},{"x":14,"y":16},{"x":44,"y":16},{"x":45,"y":16},{"x":46,"y":16},{"x":12,"y":17},{"x":13,"y":17},{"x":14,"y":17},{"x":15,"y":17},{"x":42,"y":17},{"x":43,"y":17},{"x":46,"y":17},{"x":47,"y":17},{"x":11,"y":18},{"x":12,"y":18},{"x":16,"y":18},{"x":17,"y":18},{"x":41,"y":18},{"x":42,"y":18},{"x":48,"y":18},{"x":49,"y":18},{"x":50,"y":18},{"x":10,"y":19},{"x":17,"y":19},{"x":41,"y":19},{"x":49,"y":19},{"x":11,"y":20},{"x":12,"y":20},{"x":16,"y":20},{"x":17,"y":20},{"x":41,"y":20},{"x":49,"y":20},{"x":12,"y":21},{"x":15,"y":21},{"x":41,"y":21},{"x":49,"y":21},{"x":13,"y":22},{"x":15,"y":22},{"x":41,"y":22},{"x":49,"y":22},{"x":77,"y":22},{"x":78,"y":22},{"x":79,"y":22},{"x":80,"y":22},{"x":81,"y":22},{"x":82,"y":22},{"x":98,"y":22},{"x":99,"y":22},{"x":9,"y":23},{"x":10,"y":23},{"x":11,"y":23},{"x":12,"y":23},{"x":15,"y":23},{"x":16,"y":23},{"x":17,"y":23},{"x":30,"y":23},{"x":31,"y":23},{"x":32,"y":23},{"x":33,"y":23},{"x":34,"y":23},{"x":35,"y":23},{"x":41,"y":23},{"x":49,"y":23},{"x":76,"y":23},{"x":82,"y":23},{"x":98,"y":23},{"x":10,"y":24},{"x":17,"y":24},{"x":31,"y":24},{"x":35,"y":24},{"x":41,"y":24},{"x":49,"y":24},{"x":73,"y":24},{"x":74,"y":24},{"x":75,"y":24},{"x":77,"y":24},{"x":82,"y":24},{"x":98,"y":24},{"x":9,"y":25},{"x":17,"y":25},{"x":30,"y":25},{"x":35,"y":25},{"x":41,"y":25},{"x":49,"y":25},{"x":51,"y":25},{"x":52,"y":25},{"x":53,"y":25},{"x":69,"y":25},{"x":72,"y":25},{"x":75,"y":25},{"x":76,"y":25},{"x":82,"y":25},{"x":98,"y":25},{"x":10,"y":26},{"x":17,"y":26},{"x":31,"y":26},{"x":35,"y":26},{"x":41,"y":26},{"x":50,"y":26},{"x":51,"y":26},{"x":54,"y":26},{"x":55,"y":26},{"x":56,"y":26},{"x":69,"y":26},{"x":70,"y":26},{"x":72,"y":26},{"x":82,"y":26},{"x":83,"y":26},{"x":98,"y":26},{"x":0,"y":27},{"x":1,"y":27},{"x":2,"y":27},{"x":3,"y":27},{"x":9,"y":27},{"x":17,"y":27},{"x":30,"y":27},{"x":35,"y":27},{"x":41,"y":27},{"x":55,"y":27},{"x":67,"y":27},{"x":68,"y":27},{"x":70,"y":27},{"x":71,"y":27},{"x":83,"y":27},{"x":89,"y":27},{"x":90,"y":27},{"x":91,"y":27},{"x":98,"y":27},{"x":4,"y":28},{"x":10,"y":28},{"x":17,"y":28},{"x":18,"y":28},{"x":19,"y":28},{"x":20,"y":28},{"x":31,"y":28},{"x":35,"y":28},{"x":41,"y":28},{"x":56,"y":28},{"x":57,"y":28},{"x":68,"y":28},{"x":83,"y":28},{"x":87,"y":28},{"x":88,"y":28},{"x":89,"y":28},{"x":92,"y":28},{"x":93,"y":28},{"x":94,"y":28},{"x":95,"y":28},{"x":98,"y":28},{"x":3,"y":29},{"x":9,"y":29},{"x":20,"y":29},{"x":30,"y":29},{"x":35,"y":29},{"x":41,"y":29},{"x":56,"y":29},{"x":67,"y":29},{"x":83,"y":29},{"x":84,"y":29},{"x":85,"y":29},{"x":86,"y":29},{"x":95,"y":29},{"x":96,"y":29},{"x":98,"y":29},{"x":4,"y":30},{"x":10,"y":30},{"x":20,"y":30},{"x":31,"y":30},{"x":35,"y":30},{"x":41,"y":30},{"x":57,"y":30},{"x":68,"y":30},{"x":97,"y":30},{"x":98,"y":30},{"x":3,"y":31},{"x":9,"y":31},{"x":20,"y":31},{"x":30,"y":31},{"x":35,"y":31},{"x":41,"y":31},{"x":56,"y":31},{"x":65,"y":31},{"x":66,"y":31},{"x":67,"y":31},{"x":4,"y":32},{"x":10,"y":32},{"x":20,"y":32},{"x":24,"y":32},{"x":25,"y":32},{"x":26,"y":32},{"x":31,"y":32},{"x":36,"y":32},{"x":37,"y":32},{"x":41,"y":32},{"x":57,"y":32},{"x":63,"y":32},{"x":64,"y":32},{"x":65,"y":32},{"x":4,"y":33},{"x":7,"y":33},{"x":8,"y":33},{"x":9,"y":33},{"x":20,"y":33},{"x":22,"y":33},{"x":23,"y":33},{"x":24,"y":33},{"x":25,"y":33},{"x":26,"y":33},{"x":27,"y":33},{"x":30,"y":33},{"x":37,"y":33},{"x":38,"y":33},{"x":39,"y":33},{"x":41,"y":33},{"x":56,"y":33},{"x":63,"y":33},{"x":4,"y":34},{"x":7,"y":34},{"x":20,"y":34},{"x":22,"y":34},{"x":28,"y":34},{"x":31,"y":34},{"x":39,"y":34},{"x":41,"y":34},{"x":57,"y":34},{"x":63,"y":34},{"x":4,"y":35},{"x":6,"y":35},{"x":20,"y":35},{"x":22,"y":35},{"x":28,"y":35},{"x":29,"y":35},{"x":30,"y":35},{"x":39,"y":35},{"x":40,"y":35},{"x":56,"y":35},{"x":58,"y":35},{"x":59,"y":35},{"x":60,"y":35},{"x":61,"y":35},{"x":62,"y":35},{"x":5,"y":36},{"x":6,"y":36},{"x":7,"y":36},{"x":20,"y":36},{"x":22,"y":36},{"x":57,"y":36},{"x":59,"y":36},{"x":20,"y":37},{"x":22,"y":37},{"x":57,"y":37},{"x":58,"y":37},{"x":20,"y":38},{"x":22,"y":38},{"x":20,"y":39},{"x":21,"y":39},{"x":22,"y":39}],"sourceLength":1620}
];

function min(a, b) { return a > b ? b : a; }
function max(a, b) { return a > b ? a : b; }

function initField($display, w, h, isSubTable) {
	if (!isSubTable) {
		W = w, H = h;

		$("#W").val(W);
		$("#H").val(H);

		board = [];
		for (var y = 0; y < H; ++y) {
			board[y] = [];
			for (var x = 0; x < W; ++x) {
				board[y][x] = false;
			}
		}
		initialBoard = $.extend(true, [], board);
	}

	var $tbody = $("tbody", $display);
	if ($tbody.length == 0) {
		$tbody = $("<tbody>");
		$display.append($tbody);
	}
	else {
		$tbody.children().remove();
	}

	var $ret = [];
	for (var y = 0; y < h; ++y) {
		$ret[y] = [];

		var $tr = $("<tr>");
		for (var x = 0; x < w; ++x) {
			var $td = $("<td>").append(
				$("<div>").append(
					$("<div>").append(
						$("<div>").text(Format("{0}, {1}", x, y)).append(
							$("<div>")
						)
					)
				)
			);
			$tr.append($td);

			$ret[y][x] = $td;
		}
		$tbody.append($tr);
	}

	if (!isSubTable) {
		$cell = $ret;
		command($("#command").val());
	}

	return $ret;
}

function pSet(x, y, v, $c) {
	if (typeof x == "object") {
		v = y, y = x.y, x = x.x;
	}
	if ($c == null) $c = $cell;

	if (v) $c[y][x].addClass("filled");
	else $c[y][x].removeClass("filled");
}

var MOD = 4294967296, MUL = 1103515245, INC = 12345;
function nextSeed(seed) {
	var a = seed / 65536 | 0, b = seed % 65536;
	var MUL_seed = ((a * MUL) % 65536 * 65536) + b * MUL;
	return (MUL_seed + INC) % MOD;
}

function load(str) {
	var json = typeof str == "object" ? str : JSON.parse(str);

	$cell = initField($("#display"), json.width, json.height);

	units = json.units;
	for (var i = 0, l = units.length; i < l; ++i) {
		var unit = units[i].members;
		var mx = unit[0].x, Mx = unit[0].x, my = unit[0].y;
		for (var j = 0, jl = unit.length; j < jl; ++j) {
			mx = min(mx, unit[j].x);
			Mx = max(Mx, unit[j].x);
			my = min(my, unit[j].y);
		}
		var len = Mx - mx + 1;
		marginLeft = (W - len) / 2 | 0;

		var dx = marginLeft - mx;
		var dy = -my;

		units[i].pivot.x += dx;
		units[i].pivot.y += dy;
		for (var j = 0, jl = unit.length; j < jl; ++j) {
			unit[j].x += dx;
			unit[j].y += dy;
		}
	}

	initialBoard = [];
	for (var y = 0; y < H; ++y) {
		initialBoard[y] = [];
		for (var x = 0; x < W; ++x) {
			initialBoard[y][x] = false;
			pSet(x, y, false);
		}
	}
	for (var i = 0, l = json.filled.length; i < l; ++i) {
		initialBoard[json.filled[i].y][json.filled[i].x] = true;
		pSet(json.filled[i], 1);
	}

	sourceLength = json.sourceLength;

	var $sel_seed = $("#seed");
	$sel_seed.children().remove();
	for (var i = 0, l = json.sourceSeeds.length; i < l; ++i) {
		$sel_seed.append(
			$("<option>").val(json.sourceSeeds[i]).text(json.sourceSeeds[i])
		);
	}
	$sel_seed.unbind("change").change(function() {
		sources = makeSource(+$(this).val());

		var $ul = $("#next ul");
		$ul.children().remove();
		for (var i = 0, l = sources.length; i < l; ++i) {
			var $tbl = $("<table>").prop("cellpadding", 0).prop("cellspacing", 0).addClass("board");
			var $li = $("<li>").append($tbl);
			var unit = units[sources[i] % units.length];
			var minX = unit.pivot.x, minY = unit.pivot.y, maxX = unit.pivot.x, maxY = unit.pivot.y;
			for (var j = 0, jl = unit.members.length; j < jl; ++j) {
				var x = unit.members[j].x, y = unit.members[j].y;
				minX = min(minX, x);
				maxX = max(maxX, x);
				minY = min(minY, y);
				maxY = max(maxY, y);
			}
			var w = maxX - minX + 1, h = maxY - minY + 1;
			var $c = initField($tbl, w, h, true);
			var dx = -minX, dy = -minY;
			for (var j = 0, jl = unit.members.length; j < jl; ++j) {
				var x = unit.members[j].x+dx, y = unit.members[j].y+dy;
				pSet(x, y, true, $c);
			}
			$c[unit.pivot.y+dy][unit.pivot.x+dx].addClass("pivot");
			$ul.append($li);
		}
//		$("#next").perfectScrollbar('update');
	});
	$sel_seed.prop("selectedIndex", 0);
	$sel_seed.change();

	command($("#command").val());

	$("#command").focus();
}
function makeSource(seed) {
	var ret = [];

	for (var i = 0, l = sourceLength; i < l; ++i) {
		ret[i] = (seed / 65536 | 0) & 32767;
		seed = nextSeed(seed);
	}
	for (var i = 0, l = ret.length; i < l; ++i) {
		ret[i] %= units.length;
	}
	return ret;
}
function initGame() {
sources = $("#seed").children().length > 0 ? makeSource(+$("#seed").val()) : [];
	unitId = -1;
	nowUnit = {
		pivot: { x: -1, y: -1 },
		members: []
	};
	Record = [];
	score = [0, 0];

	board = $.extend(true, [], initialBoard);
}
function isValidLocation(unit) {
	if (unit == null) unit = nowUnit;
	for (var i = 0, l = unit.members.length; i < l; ++i) {
		var x = unit.members[i].x, y = unit.members[i].y;
		if (x < 0 || x >= W || y < 0 || y >= H) return false;
		if (board[y][x]) return false;
	}
	return true;
}
function nextUnit() {
	if (++unitId >= sources.length) return false;

	nowUnit = $.extend(true, {}, units[sources[unitId]]);

	return isValidLocation();
}
function scrollNext(uid) {
	if (0 <= uid && uid < $("#next li").length) {
		$("#next").scrollTop( $("#next").scrollTop() + $("#next li").eq(uid).offset().top - 60 );
	}
}
function drawRecord($sel, rec) {
	$sel.children().remove();

	for (var i = 0, l = rec.length; i < l; ++i) {
		$sel.append(
			$("<option>").text(Format("{0}", i))
		);
	}

	$sel.unbind("change");
	$sel.change(function() {
		var sidx = $sel.prop("selectedIndex");
		for (var y = 0; y < H; ++y) {
			for (var x = 0; x < W; ++x) {
				pSet(x, y, rec[sidx].board[y][x]);
				if (typeof rec[sidx].board[y][x] == "number") $cell[y][x].addClass("pivot");
				else $cell[y][x].removeClass("pivot");
				scrollNext(rec[sidx].uid+1);
			}
		}
		var cmd = $("#finish").data("cmd");
		if (cmd != null) {
			var pos = $("#record").prop("selectedIndex");
			$("#finish pre").eq(0).text( cmd.substr(0, pos) );
			$("#finish pre").eq(1).text( cmd.substr(pos, cmd.length-pos) );
		}
		$("#score").text(Format("{0}+{1}={2}", rec[sidx].score[0], rec[sidx].score[1], rec[sidx].score[0]+rec[sidx].score[1]));
	});

	$sel.prop("selectedIndex", rec.length-1);
	$sel.change();
}
function saveRecord(rec, isNoUnit) {
	var b = $.extend(true, [], board);
	if (nowUnit.pivot.y > -1 && !isNoUnit) {
		for (var i = 0, l = nowUnit.members.length; i < l; ++i) {
			var x = nowUnit.members[i].x, y = nowUnit.members[i].y;
			b[y][x] = true;
		}
		{
			var x = nowUnit.pivot.x;
			var y = nowUnit.pivot.y;
			if (0 <= x && x < W && 0 <= y && y < H) b[y][x] = b[y][x] ? 1 : 0;
		}
	}
	rec.push({
		uid: unitId,
		board: b,
		score: $.extend(true, [], score)
	});
}
function move(x, y) {
	if (typeof x == "number") x = y = { x: x, y: y };
	var d = [x, y];

	var ret = $.extend(true, {}, nowUnit);
	var pid = ret.pivot.y % 2;
	ret.pivot.x += d[pid].x;
	ret.pivot.y += d[pid].y;
	for (var i = 0, l = ret.members.length; i < l; ++i) {
		var did = ret.members[i].y % 2;
		ret.members[i].x += d[did].x;
		ret.members[i].y += d[did].y;
	}
	return ret;
}
function rotate(r) {
	var ret = $.extend(true, {}, nowUnit);
	var px = ret.pivot.x, py = ret.pivot.y;
	for (var i = 0, l = ret.members.length; i < l; ++i) {
		var x = ret.members[i].x, y = ret.members[i].y;

		x -= y / 2 | 0;
		x -= px - (py / 2 | 0), y -= py;
		if (r == 1) {
			var nx = -y, ny = x+y;
			x = nx, y = ny;
		}
		else if (r == -1) {
			var nx = x+y, ny = -x;
			x = nx, y = ny;
		}
		x += px - (py / 2 | 0), y += py;
		x += y / 2 | 0;

		ret.members[i].x = x;
		ret.members[i].y = y;
	}
	return ret;
}
function command(str_cmd) {
	str_cmd = str_cmd.toLowerCase();

	var cmd = decode(str_cmd);
	var ls_old = 0;

	initGame(0);

	var f = nextUnit();
	saveRecord(Record);

	var lastPos = -1;
	var isFinished = false;

	if (f) {
		lastPos = cmd.length-1;
		for (var i = 0, l = cmd.length; i < l; ++i) {
			var next;
			if (cmd[i] == "W") {
				next = move(-1, 0);
			}
			else if (cmd[i] == "E") {
				next = move(1, 0);
			}
			else if (cmd[i] == "SW") {
				next = move({ x: -1, y: 1 }, { x: 0, y: 1 });
			}
			else if (cmd[i] == "SE") {
				next = move({ x: 0, y: 1 }, { x: 1, y: 1 });
			}
			else if (cmd[i] == "CW") {
				next = rotate(1);
			}
			else if (cmd[i] == "CCW") {
				next = rotate(-1);
			}
			else {
				console.log(cmd[i]);
			}

			var score1 = 0;
			for (var j = 0, jl = spells.length; j < jl; ++j) {
				var c = str_cmd.substr(0, i+1);

				var pell = spells[j].substr(1, spells[j].length-1);

				var reps = 0;
				while (1) {
					if ( c.match(spells[j]) ) {
						c = c.replace(new RegExp(".*?"+spells[j]), pell);
						++reps;
					}
					else break;
				}
				if (reps > 0) {
					var len = spells[j].length;
					score1 += 2 * len * reps + 300;
				}
			}
			score[1] = score1;

			if (next != null) {
				if (isValidLocation(next)) {
					nowUnit = next;
				}
				else {
					// lock
					for (var j = 0, jl = nowUnit.members.length; j < jl; ++j) {
						var x = nowUnit.members[j].x, y = nowUnit.members[j].y;
						board[y][x] = true;
					}
					nowUnit.pivot.x = nowUnit.pivot.y = -1;

					var size = nowUnit.members.length;
					var ls = 0;

					// clear
					var dy = [];
					for (var y = 0; y < H; ++y) dy[y] = 0;
					for (var y = H-1; y >= 0; --y) {
						var f = true;
						for (var x = 0; x < W; ++x) {
							if (!board[y][x]) {
								f = false;
								break;
							}
						}
						if (f) {
							++ls;
							for (var Y = y-1; Y >= 0; --Y) {
								for (var x = 0; x < W; ++x) {
									board[Y+1][x] = board[Y][x];
								}
							}
							for (var x = 0; x < W; ++x) {
								board[0][x] = false;
							}
							++y;
						}
					}

					var points = size + 100 * (1 + ls) * ls / 2;
					score[0] += points;
					if (ls_old > 1) score[0] += (ls_old-1) * points / 10 | 0;
					ls_old = ls;
/*
					for (var y = H-1; y > 0; --y) {
						if (dy[y] >= 0) dy[y-1] += dy[y];
					}
					for (var y = H-1; y >= 0; --y) {
						for (var x = 0; x < W; ++x) {
							if (dy[y] >= 1) board[y+dy[y]][x] = board[y][x];
						}
					}
					if (dy[0] != 0) {
						for (var x = 0; x < W; ++x) {
							board[0][x] = false;
						}
					}
*/
				}

				if (nowUnit.pivot.y < 0) {
					if ( !nextUnit() ) {
						isFinished = true;
						lastPos = i;
						saveRecord(Record, true);
						break;
					}
				}
				saveRecord(Record);
			}
		}
	}

	$("#finish").data("cmd", str_cmd.substr(0, lastPos+1));
	$("#finish pre").eq(0).css("color", (isFinished ? "blue" : "black"));
	$("#finish pre").eq(1).css("color", (isFinished ? "blue" : "black")).text(str_cmd.substr(0, lastPos+1));
	$("#finish pre").eq(2).text(str_cmd.substr(lastPos+1, str_cmd.length))

	var last = isFinished ? unitId : unitId+1;
	scrollNext(last);

	drawRecord($("#record"), Record);
}
function decode(cmd) {
	var ret = [];
	for (var i = 0, l = cmd.length; i < l; ++i) {
		ret[i] = tbl[cmd[i]];
	}
	return ret;
}

function initTable() {
	for (var i = 0, l = Tbl.length; i < l; ++i) {
		for (var j = 0, jl = Tbl[i].key.length; j < jl; ++j) {
			tbl[Tbl[i].key[j]] = Tbl[i].val;
		}
	}
}

function moveRec(d) {
	var sidx = $("#record").prop("selectedIndex");
	if (0 <= sidx+d && sidx+d < $("#record option").length) {
		$("#record").prop("selectedIndex", sidx+d).change();
	}
}

function save() {
	var data = Format('[\{"problemId":{0}, "seed":{1}, "solution":"{2}"\}]', $("#prob").prop("selectedIndex"), $("#seed").val(), $("#command").val().toLowerCase());

	var blob = new Blob([data], {type: "text/plain"}); // oCif[^B

	var fname = Format("prob{0}_ans.json", $("#prob").prop("selectedIndex"));

	// IEuEU
	if(window.navigator.msSaveBlob) {
	    window.navigator.msSaveBlob(blob, fname);
	}
	else {
	    var a = document.createElement("a");
	    a.href = URL.createObjectURL(blob);
	    a.target = "_blank";
	    a.download = fname
	    a.click();
	}
}

$(function() {
	initTable();
	$cell = initField($("#display"), +$("#W").val(), +$("#H").val());

	var $prob = $("#prob");
	for (var i = 0, l = probs.length; i < l; ++i) {
		$prob.append(
			$("<option>").val(i).text(i)
		);
	}
	$prob.change(function() {
		load(probs[$(this).prop("selectedIndex")]);
	});
	$prob.prop("selectedIndex", 0).change();

	$("#btn_prev, #btn_next").css("display", "none"); //

	$("#W, #H")
		.click(function() { this.select(); })
		.change(function() {
			$cell = initField($("#display"), +$("#W").val(), +$("#H").val());
		});

	$(document).bind("dragenter", function(e) {
		e.preventDefault();
	}).bind("dragover", function(e) {
		e.preventDefault();
	}).bind("drop", function(e) {
		var files = e.originalEvent.dataTransfer.files;
		if (files.length > 1) {
			alert("t@CB");
		}
		else if (files.length == 1) {
			var file = files[0];

			var reader = new FileReader();
			reader.readAsText(file);
			reader.onload = function(e) {
				load(reader.result);
			}
		}
		e.preventDefault();
	});

	$("#command").bind("input", function() {
		command($("#command").val());
	});

	$("#btn_recLeft").click(function() {
		moveRec(-1);
	});
	$("#btn_recRight").click(function() {
		moveRec(1);
	});
	$(document).keydown(function(e) {
		key[e.keyCode] = true;
		if (key[16]) { // Shift
			if (e.keyCode == 37) { // 
				moveRec(-1);
			}
			else if (e.keyCode == 39) { // 
				moveRec(1);
			}
		}
		if (key[17]) { // CTRL
			if (e.keyCode == 83) { // S
				save();
				e.preventDefault();
			}
		}
	}).keyup(function(e) {
		key[e.keyCode] = false;
	});

//	$("#next").perfectScrollbar();
});
